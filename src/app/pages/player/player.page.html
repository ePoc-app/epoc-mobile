<ion-content scroll-y="false">
  <div class="reader" (window:resize)="onResize($event)" [ngStyle]="getStyle()">
    <div class="pages-container" [ngStyle]="contentStyles" (touchstart)="onMouseDown($event)" (touchend)="onMouseUp($event)" (touchmove)="onMouseMove($event)">
      <div class="pages-wrapper" [ngClass]="{'scrolling': isScrolling}" [style.columnWidth]="columnWidth" [style.transform]="pageWrapperTransform">
        <ng-container *ngIf="epoc$ | async as epoc">
          <ng-container *ngFor="let content of contents">

            <ng-container *ngIf="content.type === 'cover'">
              <div class="page-content page-content-cover">
                <ion-img [src]="epoc.image"></ion-img>
                <h2>{{epoc.title}}</h2>
                <div *ngFor="let author of epoc.authors">
                  <ion-text>{{author.name}}</ion-text>
                </div>
                <div class="edition">2020 edition<br/>Inria Learning Lab</div>
              </div>
            </ng-container>

            <ng-container *ngIf="content.type === 'chapter'">
              <div class="page-content page-content-fs page-content-chapter">
                <div class="page-content-fs-inner">
                  <div class="chapter-container">
                    <div class="chapter-square"><div class="chapter-number">{{content.number}}</div></div>
                    <div class="chapter-title">{{content.name}}</div>
                  </div>
                </div>
              </div>
            </ng-container>

            <ng-container *ngIf="content.type === 'html'">
              <div class="page-content page-content-html" [innerHTML]="content.value"></div>
            </ng-container>

            <ng-container *ngIf="content.type === 'video'">
              <div class="page-content page-content-fs page-content-video">
                <div class="page-content-fs-inner">
                  <div class="ion-text-center">
                    <ion-icon name="videocam" size="large"></ion-icon>
                    <h2>{{content.name}}</h2>
                  </div>
                  <video-player [options]="{ fluid: true, autoplay: false, controls: true, sources: [{ src: content.source, type: 'video/mp4' }]}"></video-player>

                  <ion-card>
                    <ion-card-header>
                      <ion-card-title>Summary</ion-card-title>
                    </ion-card-header>
                    <ion-card-content>
                      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Animi corporis, distinctio dolorum ea, eaque esse expedita fugiat laboriosam laborum officia perferendis quaerat quis quisquam reprehenderit ullam. Corporis iste modi ut.</p>
                    </ion-card-content>
                  </ion-card>
                </div>
              </div>
            </ng-container>

            <ng-container *ngIf="content.type === 'assessment'">
              <div class="page-content page-content-assessment">
                <assessment-button [content]="content" [epoc]="epoc"></assessment-button>
              </div>
            </ng-container>

          </ng-container>
        </ng-container>
      </div>
    </div>
    <div class="reader-action">
      <div class="page-action page-prev" (click)="prevPage()"></div>
      <div class="page-action page-next" (click)="nextPage()"></div>
      <div class="reader-bookmark" (click)="toggleBookmark()">
        <ion-icon [ngClass]="isBookmarked() ? 'bookmarked':''" name="bookmark"></ion-icon>
      </div>
      <div class="reader-progress">
        <ion-progress-bar color="inria" [value]="getProgress()"></ion-progress-bar>
      </div>
    </div>
  </div>
</ion-content>
