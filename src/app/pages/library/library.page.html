<ion-header mode="ios" class="home">
  <ion-toolbar>
    <div class="logo" slot="start">
      <ion-img src="assets/img/ePoc.svg"></ion-img>
    </div>
    <ion-button class="icon-btn" slot="end" routerLink="/settings" routerDirection="forward">
      <ion-icon slot="icon-only" name="settings-outline" color="inria-blue"></ion-icon>
    </ion-button>
    <ion-button class="icon-btn" slot="end" routerLink="/about" routerDirection="forward">
      <ion-icon slot="icon-only" name="information-circle-outline" color="inria-blue"></ion-icon>
    </ion-button>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="library">
  <div class="library-items">
    <div class="library-item" *ngFor="let epoc of library">
      <div class="library-item-image" [routerLink]="'/library/'+epoc.id" [style]="'background-image:url('+epoc.image+')'"></div>
      <h3 class="library-item-title">{{epoc.title}}</h3>
      <div class="library-item-toolbar" *ngIf="epoc.downloaded">
        <ion-button class="expanded" color="inria"><span>Découvrir</span></ion-button>
        <ion-button class="round" color="inria-light" (click)="presentActionSheet(epoc)">
          <span class="ellipsis">...</span>
        </ion-button>
      </div>
      <div class="library-item-toolbar" *ngIf="!epoc.downloading && !epoc.downloaded && !epoc.unzipping">
        <ion-button class="expanded" color="inria-light" (click)="downloadEpoc(epoc)">
          <ion-icon name="cloud-download-outline" slot="start"></ion-icon>
          <span>Télécharger</span>
        </ion-button>
      </div>
      <div class="library-item-toolbar" *ngIf="epoc.downloading">
        <ion-button class="expanded" disabled="true" color="inria-light">
          <ion-icon name="sync-outline" class="spin" slot="start"></ion-icon>
          <span>Téléchargement <ng-container *ngIf="epocProgresses[epoc.id]">({{epocProgresses[epoc.id]}}%)</ng-container></span>
        </ion-button>
      </div>
      <div class="library-item-toolbar" *ngIf="epoc.unzipping">
        <ion-button class="expanded" disabled="true" color="inria-light">
          <ion-icon name="cog-outline" class="spin" slot="start"></ion-icon>
          <span>Ouverture <ng-container *ngIf="epocProgresses[epoc.id]">({{epocProgresses[epoc.id]}}%)</ng-container></span>
        </ion-button>
      </div>
    </div>
  </div>
</ion-content>
